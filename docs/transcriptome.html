<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TranscriptR manual - 2&nbsp; Transcriptome Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./igv.html" rel="next">
<link href="./quality.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">TranscriptR: Transcriptome Data Analysis Pipeline</a></li><li class="breadcrumb-item"><a href="./transcriptome.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transcriptome Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">TranscriptR manual</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/JD2112/transcriptr" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./TranscriptR-manual.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./TranscriptR-manual.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./disclaimer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Disclaimer</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TranscriptR: Transcriptome Data Analysis Pipeline</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Quality Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transcriptome.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transcriptome Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./igv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Integrative Genome Viewer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Multi_D_Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimensional Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Volcano_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Volcano plot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./heatmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">HeatMap</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./assco.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Enrichment Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./go_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Gene Ontology (GO) enrichment analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pathway_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pathway enrichment analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./setana.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Set Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./venn_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Venn analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./upset_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">UpSet Plots</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Create the input zip file for <em>methylR</em></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Use of Docker Container</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Convert DMCs table to BED</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Time calculation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">FAQs/Troubleshooting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><a href="./images/logo-final.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="./images/logo-final.png" class="img-fluid"></a></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-input-and-parameters-settings" id="toc-data-input-and-parameters-settings" class="nav-link active" data-scroll-target="#data-input-and-parameters-settings"><span class="header-section-number">2.1</span> Data input and parameters settings</a>
  <ul class="collapse">
  <li><a href="#fastq-upload" id="toc-fastq-upload" class="nav-link" data-scroll-target="#fastq-upload"><span class="header-section-number">2.1.1</span> Fastq upload</a></li>
  <li><a href="#sec-sampleinfo" id="toc-sec-sampleinfo" class="nav-link" data-scroll-target="#sec-sampleinfo"><span class="header-section-number">2.1.2</span> Sample info</a></li>
  <li><a href="#parameters-settings" id="toc-parameters-settings" class="nav-link" data-scroll-target="#parameters-settings"><span class="header-section-number">2.1.3</span> Parameters settings</a></li>
  </ul></li>
  <li><a href="#visualization-multiqc" id="toc-visualization-multiqc" class="nav-link" data-scroll-target="#visualization-multiqc"><span class="header-section-number">2.2</span> Visualization: MultiQC</a></li>
  <li><a href="#visualization-plots" id="toc-visualization-plots" class="nav-link" data-scroll-target="#visualization-plots"><span class="header-section-number">2.3</span> Visualization: Plots</a></li>
  <li><a href="#visualization-deg-table" id="toc-visualization-deg-table" class="nav-link" data-scroll-target="#visualization-deg-table"><span class="header-section-number">2.4</span> Visualization: DEG table</a></li>
  <li><a href="#visualization-intersectde" id="toc-visualization-intersectde" class="nav-link" data-scroll-target="#visualization-intersectde"><span class="header-section-number">2.5</span> Visualization: InterSectDE</a></li>
  <li><a href="#session-logs" id="toc-session-logs" class="nav-link" data-scroll-target="#session-logs"><span class="header-section-number">2.6</span> Session &amp; logs</a></li>
  <li><a href="#download-results" id="toc-download-results" class="nav-link" data-scroll-target="#download-results"><span class="header-section-number">2.7</span> Download Results</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/JD2112/transcriptr/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">TranscriptR: Transcriptome Data Analysis Pipeline</a></li><li class="breadcrumb-item"><a href="./transcriptome.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transcriptome Analysis</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-transcript" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Transcriptome Analysis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-important callout-titled" title="IMPORTANT">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
IMPORTANT
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>PLEASE NOTE</strong> WE INCLUDED THE POSSIBILITY OF THE HUMAN TRANSCRIPTOME DATA ANALYSIS FROM THE SEQUENCE DATA. NONE OF THE OWNER OF THE CODE OR DATA CENTER IS RESPONSIBLE FOR HANDLING THE HUMAN DATA. IT IS UPTO THE USER IF THEY WANT TO USE THE ONLINE VERSION FOR HUMAN DATA ANALYSIS.</p>
</div>
</div>
</div>
<p>Transcriptome analysis has divided in several parts for the data upload, analysis and visualizing the results.</p>
<section id="data-input-and-parameters-settings" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-input-and-parameters-settings"><span class="header-section-number">2.1</span> Data input and parameters settings</h2>
<p>In this section, for better user accessibility, we divided this into 3 sub-parts -</p>
<div id="fig-trans1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcript1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="images/transcriptome/transcript1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Fastq upload
</figcaption>
</figure>
</div>
<section id="fastq-upload" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="fastq-upload"><span class="header-section-number">2.1.1</span> Fastq upload</h3>
<ol type="1">
<li>If the user performed the <strong><em>Quality analysis</em></strong> (<a href="quality.html" class="quarto-xref"><span>Chapter 1</span></a>) already, they don’t need to upload the data again, they can use <strong><em>‘continue from Quality Analysis’</em></strong>.</li>
<li>The user can also upload the data directly by selecting <strong><em>‘upload data’</em></strong> option.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Please note it will take some time to upload the data and once the data uploaded, the list will be displayed in the <strong>Data file viewer</strong> (see <a href="quality.html#fig-qual2" class="quarto-xref">Figure&nbsp;<span>1.2</span></a> <a href="#fig-trans1" class="quarto-xref">Figure&nbsp;<span>2.1</span></a>).</p>
</div>
</div>
</section>
<section id="sec-sampleinfo" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="sec-sampleinfo"><span class="header-section-number">2.1.2</span> Sample info</h3>
<p>In the <strong><em>Sample info</em></strong> section, users need to upload the ‘sample sheet/meta data file’ that includes atleast two columns (‘sample name’ and ‘sample condition’) (see <a href="#fig-trans2" class="quarto-xref">Figure&nbsp;<span>2.2</span></a>). For Differential Gene Expression (DEG) analysis, user need to provide the comparison conditions as showed in <a href="#fig-trans2" class="quarto-xref">Figure&nbsp;<span>2.2</span></a>.</p>
<div id="fig-trans2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcriptr3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="images/transcriptome/transcriptr3.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: Sample information
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>After uploading the files, all files will be appear in the browser window (see <a href="#fig-trans2" class="quarto-xref">Figure&nbsp;<span>2.2</span></a>), please check and verify everything is properly uploaded.</li>
<li>User can upload any file format, such as text (.txt), CSV (.csv), Excel (.xls, .xlsx).</li>
</ol>
</div>
</div>
</section>
<section id="parameters-settings" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="parameters-settings"><span class="header-section-number">2.1.3</span> Parameters settings</h3>
<p>Selecting the right parameters for the analysis is the key to the successful run of <strong>TranscriptR</strong>. The <strong>parameters settings</strong> (see <a href="#fig-trans3" class="quarto-xref">Figure&nbsp;<span>2.3</span></a>) are sub-divided for better understanding and view -</p>
<div id="fig-trans3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcriptr4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="images/transcriptome/transcriptr4.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: Parameters settings
</figcaption>
</figure>
</div>
<section id="species-and-database" class="level4" data-number="2.1.3.1">
<h4 data-number="2.1.3.1" class="anchored" data-anchor-id="species-and-database"><span class="header-section-number">2.1.3.1</span> Species and database</h4>
<ol type="1">
<li><strong>Select Species</strong>: The user need to select the <em>species</em> from the species list. Here we provided more than 350 species presented in the ‘biomart’ for the analysis. Note that all other species than ‘Human’, ‘Mouse’ and ‘Rat’ come with the <strong>scientific name</strong> as provided in <a href="http://www.ensembl.org/info/about/species.html" target="_blank">‘Ensembl’</a>. The default is ‘Human’.</li>
<li><strong>Select release version</strong>: The default is <em>latest</em>. The user can choose other database version as provided by <a href="https://ftp.ensembl.org/pub/" target="_blank">Ensembl</a>. Please provide the number only in the ‘box’, example, if you want to use version ‘109’, provide only ‘109’ (see <a href="#fig-trans4" class="quarto-xref">Figure&nbsp;<span>2.4</span></a>).</li>
</ol>
<div id="fig-trans4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcript5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5"><img src="images/transcriptome/transcript5.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.4: Parameters: Species and database
</figcaption>
</figure>
</div>
</section>
<section id="alignment-parameters" class="level4" data-number="2.1.3.2">
<h4 data-number="2.1.3.2" class="anchored" data-anchor-id="alignment-parameters"><span class="header-section-number">2.1.3.2</span> Alignment parameters</h4>
<ol type="1">
<li><strong>Choose R1/R2 suffix</strong>: For <em>paired-end</em> analysis, please provide the R1 and R2 suffixes.</li>
<li><strong>Overhang</strong>: The default is 100.</li>
<li><strong>Choose sequence type</strong>: Choose whether the sequence is <em>stranded</em>, <em>unstranded</em> or <em>reverse-stranded</em>.</li>
<li><strong>Choose ID</strong>: Select display ID for <em>gene id</em> or <em>transcriptome id</em>. Default is <em>gene ID</em>.</li>
</ol>
<div id="fig-trans5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcript6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6"><img src="images/transcriptome/transcript6.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.5: Parameters: Alignment
</figcaption>
</figure>
</div>
</section>
<section id="deg-filtration" class="level4" data-number="2.1.3.3">
<h4 data-number="2.1.3.3" class="anchored" data-anchor-id="deg-filtration"><span class="header-section-number">2.1.3.3</span> DEG filtration</h4>
<p>As <strong>‘TranscriptR’</strong> provides the differential gene expression (DEG) analysis result, user need to provide the required filtration for the analysis.<br>
1. <strong>Enter CPM value</strong>: The default is 1.<br>
2. <strong>Number of samples</strong>: The default is 3.<br>
3. <strong>Choose logFC value</strong>: The default is 1.5.<br>
4. <strong>Choose FDR value</strong>: The default is 0.05.</p>
<div id="fig-trans6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcript7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7"><img src="images/transcriptome/transcript7.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.6: Parameters: DEF filtration
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="visualization-multiqc" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="visualization-multiqc"><span class="header-section-number">2.2</span> Visualization: MultiQC</h2>
<p>Please see <a href="quality.html" class="quarto-xref"><span>Chapter 1</span></a> for details.</p>
</section>
<section id="visualization-plots" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="visualization-plots"><span class="header-section-number">2.3</span> Visualization: Plots</h2>
<p>Since <strong>TranscriptR</strong> provides differential gene expression (DEG) analysis by <strong>three</strong> different pipelines, namely <em>EdgeR</em>, <em>DESeq2</em> and <em>limma</em>, all plots are divided into these three results.</p>
<div id="fig-trans7" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcript8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" data-glightbox="description: .lightbox-desc-8"><img src="images/transcriptome/transcript8.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.7: Visualization: plots
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>The plots will be displayed as <a href="#fig-trans7" class="quarto-xref">Figure&nbsp;<span>2.7</span></a> in a PDF format. All of these can be downloaded when the user download the results from the <em>‘Download results’</em> tab.</li>
<li>Please note, if the plots are not loaded after the <em>job</em> completed and clicked on ‘show BoxPlot/Show MDS Plot’ button, refresh the browser and it will appear in the box.</li>
</ol>
</div>
</div>
</section>
<section id="visualization-deg-table" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="visualization-deg-table"><span class="header-section-number">2.4</span> Visualization: DEG table</h2>
<p>We provided differential gene expression (DEG) analysis result as a table format (see <a href="#fig-trans8" class="quarto-xref">Figure&nbsp;<span>2.8</span></a>). To display the table, user need to - &nbsp; 1. choose the analysis type (as <strong>TranscriptR</strong> provides three different pipeline results), such as <em>EdgeR analysis</em>, <em>DESeq analysis</em> or <em>limma analysis</em> and<br>
2. select DEG table from the drop-down list. The list is generated from the information provided by the <em>comparison table</em>.</p>
<div id="fig-trans8" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcript9.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" data-glightbox="description: .lightbox-desc-9"><img src="images/transcriptome/transcript9.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.8: Visualization: DEG table
</figcaption>
</figure>
</div>
<p>In the DEG table, we added information for -<br>
1. <strong>ID</strong>: ENSEMBL <em>gene ID</em> or <em>transcript ID</em><br>
2. <strong>logFC</strong>: log fold change value for each ID. Red color shows the higher expression and blue represents the low expression (same corresponds to <em>gene symbol</em>).<br>
3. <strong>logCPM</strong>: log CPM value provided<br>
4. <strong>P_value</strong>: <em>p</em>-value provided for each ID.<br>
5. <strong>FDR</strong>: FDR provided for each ID.<br>
6. <strong>Gene Symbol</strong>: official gene symbol added in the table. Coloured according to the <em>logFC</em> value.<br>
7. <strong>Ensembl link</strong>: we added external link for ensembl database to view further information on the ID.<br>
8. <strong>GeneCard link</strong>: we added genecard database link for more information on the ID.<br>
9. <strong>Gene details</strong>: Clicking on <em>’show details</em> button will result to display the boxplot of CPM data for each group (<strong>see the note below</strong>) and the gene information from <strong>HGNC</strong> (human only).<br>
10. <strong>Chr</strong>: Chromosomal location<br>
11. <strong>Start</strong>: Start position of the chromosome<br>
12. <strong>End</strong>: End position of the chromosome<br>
13. <strong>Strand</strong>: chromosomal strand<br>
14. <strong>Types</strong>: types of genes/transcript.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Please note, we already mentioned that the user may need to reload/refresh the browser after successful run to visualize the results. In this process, the uploaded data table (<strong>mentioned in <a href="#sec-sampleinfo" class="quarto-xref"><span>Section 2.1.2</span></a></strong>) will be lost. To view the CPM boxplot, the user need the upload the sample information data tables again and click on <em>‘Show details’</em> on the DEG table.</p>
</div>
</div>
</section>
<section id="visualization-intersectde" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="visualization-intersectde"><span class="header-section-number">2.5</span> Visualization: InterSectDE</h2>
<p>Further, we implemented intersection function for the above-mentioned three types of DEG analyses in the <em>’InterSectDEG</em> tab.<br>
1. To visualize the result, the user needs to select the <em>same result</em> table (eg. groupAvsgroupB) for all three analyses. <strong>Please remember selecting different table may results incorrect table and figure.<br>
2. After selecting same result table files from all three analyses, click to <em>‘show intersect result’</em>. Both intersect table and Venn diagram will appear in respective boxes.<br>
3. To download the full table, check to show </strong>all** entries (see <a href="#fig-trans9" class="quarto-xref">Figure&nbsp;<span>2.9</span></a>).<br>
4. The Venn diagram can be downloaded in different file format with respective height, width or resolution (see <a href="#fig-trans9" class="quarto-xref">Figure&nbsp;<span>2.9</span></a>).</p>
<div id="fig-trans9" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trans9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/transcriptome/transcript10.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" data-glightbox="description: .lightbox-desc-10"><img src="images/transcriptome/transcript10.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trans9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.9: InterSect result
</figcaption>
</figure>
</div>
<p>Below is the details of <em>‘InterSect DEG’</em> table result (see <a href="#fig-trans9" class="quarto-xref">Figure&nbsp;<span>2.9</span></a>) -<br>
1. <strong>id</strong><br>
2. <strong>name</strong><br>
3. <strong>chr</strong><br>
4. <strong>start</strong><br>
5. <strong>end</strong><br>
6. <strong>strand</strong><br>
7. <strong>biotype</strong><br>
8. <strong>edgeR_logFC</strong><br>
9. <strong>edgeR_logCPM</strong><br>
10. <strong>edgeR_PValue</strong><br>
11. <strong>edgeR_FDR</strong><br>
12. <strong>edgeR_baseMean</strong><br>
13. <strong>DESeq2_log2FoldChange</strong><br>
14. <strong>DESeq2_lfcSE</strong><br>
15. <strong>DESeq2_stat</strong><br>
16. <strong>DESeq2_pvalue</strong><br>
17. <strong>DESeq2_padj</strong><br>
18. <strong>limma_logFC</strong><br>
19. <strong>limma_AveExpr</strong><br>
20. <strong>limma_t</strong><br>
21. <strong>limma_P.Value</strong><br>
22. <strong>limma_adj.P.Val</strong><br>
23. <strong>limma_B</strong></p>
</section>
<section id="session-logs" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="session-logs"><span class="header-section-number">2.6</span> Session &amp; logs</h2>
<p>We included the next tab to show <em>‘GTF information’</em>, <em>‘Reference information’</em>, <em>‘Shiny logs’</em> and <em>‘Session information’</em> for the pipeline run.</p>
</section>
<section id="download-results" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="download-results"><span class="header-section-number">2.7</span> Download Results</h2>
<p>In the <em>‘Download results’</em> tab, user can download all results performed and saved during the <strong>Transcriptome Analysis</strong> run in a zip folder. This also contains the snakemake and session logs.</p>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;2.1: Fastq upload</span>
<span class="glightbox-desc lightbox-desc-3">Figure&nbsp;2.2: Sample information</span>
<span class="glightbox-desc lightbox-desc-4">Figure&nbsp;2.3: Parameters settings</span>
<span class="glightbox-desc lightbox-desc-5">Figure&nbsp;2.4: Parameters: Species and database</span>
<span class="glightbox-desc lightbox-desc-6">Figure&nbsp;2.5: Parameters: Alignment</span>
<span class="glightbox-desc lightbox-desc-7">Figure&nbsp;2.6: Parameters: DEF filtration</span>
<span class="glightbox-desc lightbox-desc-8">Figure&nbsp;2.7: Visualization: plots</span>
<span class="glightbox-desc lightbox-desc-9">Figure&nbsp;2.8: Visualization: DEG table</span>
<span class="glightbox-desc lightbox-desc-10">Figure&nbsp;2.9: InterSect result</span>
</div>
</section>

<p>
Copyright ©
<script>document.write(new Date().getFullYear())</script>
Massimiliano Volpe, Jyotirmoy Das All Rights Reserved
</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./quality.html" class="pagination-link" aria-label="Quality Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Quality Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./igv.html" class="pagination-link" aria-label="Integrative Genome Viewer">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Integrative Genome Viewer</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/JD2112/transcriptr/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"fade","openEffect":"fade","descPosition":"right","loop":false,"selector":".lightbox"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>